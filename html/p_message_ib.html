<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BEAST: The message information model</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BEAST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">The message information model </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="s_message_ib"></a>
The message information model</h1>
<p >Everything within the baltrad messaging framework is dependent of varioustypes of messages.</p>
<p >These messages can be anything from simple keep alive message to complex variants like product generation messages and run job messages. Some messages are only used within the framework itself and is not intended for going outside the core software and other messages are intended for sending to other nodes or other modules like the product generation frameworks.</p>
<p >Below is the list of currently supported messages. It should be observed that there is no actual HTTP-label since the HTTP protocol is supposed to be supported by external adaptors. Instead the XML-structure is shown as well as the XMLRPC protocol since this is included in the beast framework.</p>
<p >Here all current messages are listed and a brief explanation on what their purpose is.</p>
<h1><a class="anchor" id="s_message_ib_alert"></a>
Alert message</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltAlertMessage.html" title="Alert message.">eu::baltrad::beast::message::mo::BltAlertMessage</a></dd></dl>
<p>As the name hints, the alert message is used for sending alert messages within and outside the system.</p>
<h2><a class="anchor" id="s_message_ib_alert_usage"></a>
Usage</h2>
<pre class="fragment">BltAlertMessage msg = new BltAlertMessage();
msg.setCode("E0001");
msg.setMessage("Communication error");
</pre><h2><a class="anchor" id="s_message_ib_alert_xml"></a>
XML</h2>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;bltalert&gt;
  &lt;code&gt;ABC&lt;/code&gt;
  &lt;message&gt;server failure&lt;/message&gt;
&lt;/bltalert&gt;
</pre><h2><a class="anchor" id="s_message_ib_alert_xmlrpc"></a>
XMLRPC</h2>
<pre class="fragment">method = "alert"
objects = {String(code), String(message)}
</pre><h1><a class="anchor" id="s_message_ib_command"></a>
Command message</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltCommandMessage.html" title="Represents a simple command message containing a command string.">eu::baltrad::beast::message::mo::BltCommandMessage</a></dd></dl>
<p>This message is used for sending command-like strings around, for example runscript.sh. It is mostly used for communicating with product generators.</p>
<h2><a class="anchor" id="s_message_ib_command_usage"></a>
Usage</h2>
<pre class="fragment">BltCommandMessage msg = new BltCommandMessage();
msg.setCommand("ls -l");
</pre><h2><a class="anchor" id="s_message_ib_command_xml"></a>
XML</h2>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;bltcommand&gt;
  &lt;command&gt;runscript.sh&lt;/command&gt;
&lt;/bltcommand&gt;
</pre><h2><a class="anchor" id="s_message_ib_command_xmlrpc"></a>
XMLRPC</h2>
<pre class="fragment">method = "execute"
objects = {String(command)}
</pre><h1><a class="anchor" id="s_message_ib_data"></a>
Data message</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltDataMessage.html" title="The data message that is distributed within the framework.">eu::baltrad::beast::message::mo::BltDataMessage</a></dd></dl>
<p>Internal message used for passing on information that there is a file available. Usually this message is passed on by an external data exchange mechanism. The file is the metadata structure that is provided by the baltrad-db apis. I.e. there is no XML or XMLRPC associated with the data message.</p>
<h2><a class="anchor" id="s_message_ib_data_usage"></a>
Usage</h2>
<pre class="fragment">import eu.baltrad.fc.oh5.File;
...
File h5file = catalog.catalog(...);
BltDataMessage msg = new BltDataMessage();
msg.setFile(h5file);
</pre><p >but the usage that probably is going to be used the most is actually in the router rules.</p>
<pre class="fragment">  public IBltMessage handle(IBltMessage msg) {
    IBltMessage result = null;
    if (msg instanceof BltDataMessage) {
      File ohfile = ((BltDataMessage)msg).getFile();
      ...
    }
    return result;
  }
</pre><h1><a class="anchor" id="s_message_ib_dexdata"></a>
Dex data message</h1>
<dl class="section see"><dt>See also</dt><dd>eu::baltrad::beast::message::mo::BltDexDataMessage</dd></dl>
<p>This message is an oddball message and can be used for transmitting a h5file to another node. However, it does not contain the actual binary data or even the filename. This information must be added by the supporting adaptor in the same way as the receiving end must specifically set the file name.</p>
<h2><a class="anchor" id="s_message_ib_dexdata_usage"></a>
Usage</h2>
<pre class="fragment">BltDexDataMessage msg = new BltDexDataMessage();
msg.setFilename("/tmp/somefile.h5");
</pre><h2><a class="anchor" id="s_message_ib_dexdata_xml"></a>
XML</h2>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;bltdexdata/&gt;
</pre><h2><a class="anchor" id="s_message_ib_command_xmlrpc"></a>
XMLRPC</h2>
<p ><b>Not supported</b></p>
<h1><a class="anchor" id="s_message_ib_generate"></a>
Generate message</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltGenerateMessage.html">eu::baltrad::beast::message::mo::BltGenerateMessage</a></dd></dl>
<p>The generation message is probably going to be one of the more used messages message since it is the message for product generation.</p>
<p >It is up to the product generation frameworks to provide the name of the algorithm and how the arguments are supposed to be passed on. For example, rave takes a list of arguments while rack on the other hand takes one string containing all metadata. However, if a product generator is going to be used as default by beast, they must obey the format of the beast-specific rules for a number of algorithms. (see beast-algorithm table TBD).</p>
<h2><a class="anchor" id="s_message_ib_generate_usage"></a>
Usage</h2>
<pre class="fragment">BltGenerateMessage msg = new BltGenerateMessage();
msg.setAlgorithm("eu.baltrad.beast.VolumeComposite");
msg.setFiles(new String[]{"x1.h5", "x2.h5"});
msg.setArguments(new String[]{"--area=nrd2km", "--height=500", "--method=PCAPPI"});
</pre><h2><a class="anchor" id="s_message_ib_generate_xml"></a>
XML</h2>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;bltgenerate&gt;
  &lt;algorithm&gt;eu.baltrad.beast.VolumeComposite&lt;/algorithm&gt;
  &lt;filelist&gt;
    &lt;file&gt;x1.5&lt;/file&gt;
    &lt;file&gt;x2.h5&lt;/file&gt;
  &lt;/filelist&gt;
  &lt;arguments&gt;
    &lt;arg&gt;--area=nrd2km&lt;/arg&gt;
    &lt;arg&gt;--height=500&lt;/arg&gt;
    &lt;arg&gt;--method=PCAPPI&lt;/arg&gt;
  &lt;/arguments&gt;
&lt;/bltgenerate&gt;
</pre><h2><a class="anchor" id="s_message_ib_generate_xmlrpc"></a>
XMLRPC</h2>
<pre class="fragment">method = "generate"
objects = {String(algorithm), Array(String(file), String(file),..), Array(String(argument), String(argument),..)}
</pre><h1><a class="anchor" id="s_message_ib_multirouted"></a>
Multi routed message</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltMultiRoutedMessage.html">eu::baltrad::beast::message::mo::BltMultiRoutedMessage</a></dd></dl>
<p>If you for example want to explicitly specify several routes you can use the multi routed message. This is a good way to override the router rules but you need to be aware that if the route changes name you will have to modify the message as well. However, it can be quite useful if you want to ensure that you get the messages to specific nodes.</p>
<p >Since this is an internal message used for routing there is no XML or XMLRPC protocol.</p>
<h2><a class="anchor" id="s_message_ib_multirouted_usage"></a>
Usage</h2>
<pre class="fragment">BltMultiRoutedMessage msg = new BltMultiRoutedMessage();
List&lt;String&gt; destinations = new ArrayList&lt;String&gt;();
destinations.add("XMLRPC_1");
destinations.add("OTHERNODE");
msg.setDestinations(destinations);
msg.setMessage(msgtosend);
</pre><h1><a class="anchor" id="s_message_ib_routed"></a>
Routed message</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltRoutedMessage.html">eu::baltrad::beast::message::mo::BltRoutedMessage</a></dd></dl>
<p>This is more or less like <a class="el" href="p_message_ib.html#s_message_ib_multirouted">Multi Routed Message</a> but used for specifying one individual route.</p>
<p >Since this is an internal message used for routing there is no XML or XMLRPC protocol.</p>
<h2><a class="anchor" id="s_message_ib_routed_usage"></a>
Usage</h2>
<pre class="fragment">BltRoutedMessage msg = new BltRoutedMessage();
msg.setDestination("XMLRPC_1");
msg.setMessage(msgtosend);
</pre><h1><a class="anchor" id="s_message_ib_triggerjob"></a>
Trigger job message</h1>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltTriggerJobMessage.html" title="A message for triggering specific jobs/rules.">eu::baltrad::beast::message::mo::BltTriggerJobMessage</a></dd></dl>
<p>A quite useful message if you know the names of the registered rules and want to trigger a specific rule. This message is for example used by the scheduler.</p>
<h2><a class="anchor" id="s_message_ib_triggerjob_usage"></a>
Usage</h2>
<pre class="fragment">BltTriggerJobMessage msg = new BltTriggerJobMessage();
msg.setId("abc");
msg.setName("rulename");
msg.setArguments(new String[]{"a1","a2"});
</pre><h2><a class="anchor" id="s_message_ib_triggerjob_xml"></a>
XML</h2>
<pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;blttriggerjob&gt;
  &lt;id&gt;abc&lt;/id&gt;
  &lt;name&gt;rulename&lt;/name&gt;
  &lt;arguments&gt;
    &lt;arg&gt;a1&lt;/arg&gt;
    &lt;arg&gt;a2&lt;/arg&gt;
  &lt;/arguments&gt;
&lt;/blttriggerjob&gt;
</pre><p >If you want to react specically on a trigger in a rule, you can implement it like this</p>
<pre class="fragment">  public IBltMessage handle(IBltMessage msg) {
    if (msg instanceof BltTriggerJobMessage) {
      ...
    }
    ...
  }
</pre><h2><a class="anchor" id="s_message_ib_triggerjob_xmlrpc"></a>
XMLRPC</h2>
<p >The usage of xmlrpc for job triggering is quite obscure but it is possible. It could for example for knowing that a specific trigger has been run or similar.</p>
<pre class="fragment">method = "triggerjob"
objects = {String(id), String(jobname), Array(String(argument), String(argument),..)}
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
