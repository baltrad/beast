\hypertarget{p_message_ib_s_message_ib}{}\doxysection{The message information model}\label{p_message_ib_s_message_ib}
Everything within the baltrad messaging framework is dependent of varioustypes of messages.

These messages can be anything from simple keep alive message to complex variants like product generation messages and run job messages. Some messages are only used within the framework itself and is not intended for going outside the core software and other messages are intended for sending to other nodes or other modules like the product generation frameworks.

Below is the list of currently supported messages. It should be observed that there is no actual HTTP-\/label since the HTTP protocol is supposed to be supported by external adaptors. Instead the XML-\/structure is shown as well as the XMLRPC protocol since this is included in the beast framework.

Here all current messages are listed and a brief explanation on what their purpose is.\hypertarget{p_message_ib_s_message_ib_alert}{}\doxysection{Alert message}\label{p_message_ib_s_message_ib_alert}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltAlertMessage}{eu\+::baltrad\+::beast\+::message\+::mo\+::\+Blt\+Alert\+Message}}
\end{DoxySeeAlso}
As the name hints, the alert message is used for sending alert messages within and outside the system.\hypertarget{p_message_ib_s_message_ib_alert_usage}{}\doxysubsection{Usage}\label{p_message_ib_s_message_ib_alert_usage}
\begin{DoxyVerb}BltAlertMessage msg = new BltAlertMessage();
msg.setCode("E0001");
msg.setMessage("Communication error");
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_alert_xml}{}\doxysubsection{XML}\label{p_message_ib_s_message_ib_alert_xml}
\begin{DoxyVerb}<?xml version="1.0" encoding="UTF-8"?>
<bltalert>
  <code>ABC</code>
  <message>server failure</message>
</bltalert>
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_alert_xmlrpc}{}\doxysubsection{XMLRPC}\label{p_message_ib_s_message_ib_alert_xmlrpc}
\begin{DoxyVerb}method = "alert"
objects = {String(code), String(message)}
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_command}{}\doxysection{Command message}\label{p_message_ib_s_message_ib_command}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltCommandMessage}{eu\+::baltrad\+::beast\+::message\+::mo\+::\+Blt\+Command\+Message}}
\end{DoxySeeAlso}
This message is used for sending command-\/like strings around, for example runscript.\+sh. It is mostly used for communicating with product generators.\hypertarget{p_message_ib_s_message_ib_command_usage}{}\doxysubsection{Usage}\label{p_message_ib_s_message_ib_command_usage}
\begin{DoxyVerb}BltCommandMessage msg = new BltCommandMessage();
msg.setCommand("ls -l");
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_command_xml}{}\doxysubsection{XML}\label{p_message_ib_s_message_ib_command_xml}
\begin{DoxyVerb}<?xml version="1.0" encoding="UTF-8"?>
<bltcommand>
  <command>runscript.sh</command>
</bltcommand>
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_command_xmlrpc}{}\doxysubsection{XMLRPC}\label{p_message_ib_s_message_ib_command_xmlrpc}
\begin{DoxyVerb}method = "execute"
objects = {String(command)}
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_data}{}\doxysection{Data message}\label{p_message_ib_s_message_ib_data}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltDataMessage}{eu\+::baltrad\+::beast\+::message\+::mo\+::\+Blt\+Data\+Message}}
\end{DoxySeeAlso}
Internal message used for passing on information that there is a file available. Usually this message is passed on by an external data exchange mechanism. The file is the metadata structure that is provided by the baltrad-\/db apis. I.\+e. there is no XML or XMLRPC associated with the data message.\hypertarget{p_message_ib_s_message_ib_data_usage}{}\doxysubsection{Usage}\label{p_message_ib_s_message_ib_data_usage}
\begin{DoxyVerb}import eu.baltrad.fc.oh5.File;
...
File h5file = catalog.catalog(...);
BltDataMessage msg = new BltDataMessage();
msg.setFile(h5file);
\end{DoxyVerb}


but the usage that probably is going to be used the most is actually in the router rules.

\begin{DoxyVerb}  public IBltMessage handle(IBltMessage msg) {
    IBltMessage result = null;
    if (msg instanceof BltDataMessage) {
      File ohfile = ((BltDataMessage)msg).getFile();
      ...
    }
    return result;
  }
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_dexdata}{}\doxysection{Dex data message}\label{p_message_ib_s_message_ib_dexdata}
\begin{DoxySeeAlso}{See also}
eu\+::baltrad\+::beast\+::message\+::mo\+::\+Blt\+Dex\+Data\+Message
\end{DoxySeeAlso}
This message is an oddball message and can be used for transmitting a h5file to another node. However, it does not contain the actual binary data or even the filename. This information must be added by the supporting adaptor in the same way as the receiving end must specifically set the file name.\hypertarget{p_message_ib_s_message_ib_dexdata_usage}{}\doxysubsection{Usage}\label{p_message_ib_s_message_ib_dexdata_usage}
\begin{DoxyVerb}BltDexDataMessage msg = new BltDexDataMessage();
msg.setFilename("/tmp/somefile.h5");
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_dexdata_xml}{}\doxysubsection{XML}\label{p_message_ib_s_message_ib_dexdata_xml}
\begin{DoxyVerb}<?xml version="1.0" encoding="UTF-8"?>
<bltdexdata/>
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_command_xmlrpc}{}\doxysubsection{XMLRPC}\label{p_message_ib_s_message_ib_command_xmlrpc}
{\bfseries{Not supported}}\hypertarget{p_message_ib_s_message_ib_generate}{}\doxysection{Generate message}\label{p_message_ib_s_message_ib_generate}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltGenerateMessage}{eu\+::baltrad\+::beast\+::message\+::mo\+::\+Blt\+Generate\+Message}}
\end{DoxySeeAlso}
The generation message is probably going to be one of the more used messages message since it is the message for product generation.

It is up to the product generation frameworks to provide the name of the algorithm and how the arguments are supposed to be passed on. For example, rave takes a list of arguments while rack on the other hand takes one string containing all metadata. However, if a product generator is going to be used as default by beast, they must obey the format of the beast-\/specific rules for a number of algorithms. (see beast-\/algorithm table TBD).\hypertarget{p_message_ib_s_message_ib_generate_usage}{}\doxysubsection{Usage}\label{p_message_ib_s_message_ib_generate_usage}
\begin{DoxyVerb}BltGenerateMessage msg = new BltGenerateMessage();
msg.setAlgorithm("eu.baltrad.beast.VolumeComposite");
msg.setFiles(new String[]{"x1.h5", "x2.h5"});
msg.setArguments(new String[]{"--area=nrd2km", "--height=500", "--method=PCAPPI"});
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_generate_xml}{}\doxysubsection{XML}\label{p_message_ib_s_message_ib_generate_xml}
\begin{DoxyVerb}<?xml version="1.0" encoding="UTF-8"?>
<bltgenerate>
  <algorithm>eu.baltrad.beast.VolumeComposite</algorithm>
  <filelist>
    <file>x1.5</file>
    <file>x2.h5</file>
  </filelist>
  <arguments>
    <arg>--area=nrd2km</arg>
    <arg>--height=500</arg>
    <arg>--method=PCAPPI</arg>
  </arguments>
</bltgenerate>
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_generate_xmlrpc}{}\doxysubsection{XMLRPC}\label{p_message_ib_s_message_ib_generate_xmlrpc}
\begin{DoxyVerb}method = "generate"
objects = {String(algorithm), Array(String(file), String(file),..), Array(String(argument), String(argument),..)}
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_multirouted}{}\doxysection{Multi routed message}\label{p_message_ib_s_message_ib_multirouted}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltMultiRoutedMessage}{eu\+::baltrad\+::beast\+::message\+::mo\+::\+Blt\+Multi\+Routed\+Message}}
\end{DoxySeeAlso}
If you for example want to explicitly specify several routes you can use the multi routed message. This is a good way to override the router rules but you need to be aware that if the route changes name you will have to modify the message as well. However, it can be quite useful if you want to ensure that you get the messages to specific nodes.

Since this is an internal message used for routing there is no XML or XMLRPC protocol.\hypertarget{p_message_ib_s_message_ib_multirouted_usage}{}\doxysubsection{Usage}\label{p_message_ib_s_message_ib_multirouted_usage}
\begin{DoxyVerb}BltMultiRoutedMessage msg = new BltMultiRoutedMessage();
List<String> destinations = new ArrayList<String>();
destinations.add("XMLRPC_1");
destinations.add("OTHERNODE");
msg.setDestinations(destinations);
msg.setMessage(msgtosend);
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_routed}{}\doxysection{Routed message}\label{p_message_ib_s_message_ib_routed}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltRoutedMessage}{eu\+::baltrad\+::beast\+::message\+::mo\+::\+Blt\+Routed\+Message}}
\end{DoxySeeAlso}
This is more or less like \mbox{\hyperlink{p_message_ib_s_message_ib_multirouted}{Multi Routed Message}} but used for specifying one individual route.

Since this is an internal message used for routing there is no XML or XMLRPC protocol.\hypertarget{p_message_ib_s_message_ib_routed_usage}{}\doxysubsection{Usage}\label{p_message_ib_s_message_ib_routed_usage}
\begin{DoxyVerb}BltRoutedMessage msg = new BltRoutedMessage();
msg.setDestination("XMLRPC_1");
msg.setMessage(msgtosend);
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_triggerjob}{}\doxysection{Trigger job message}\label{p_message_ib_s_message_ib_triggerjob}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classeu_1_1baltrad_1_1beast_1_1message_1_1mo_1_1BltTriggerJobMessage}{eu\+::baltrad\+::beast\+::message\+::mo\+::\+Blt\+Trigger\+Job\+Message}}
\end{DoxySeeAlso}
A quite useful message if you know the names of the registered rules and want to trigger a specific rule. This message is for example used by the scheduler.\hypertarget{p_message_ib_s_message_ib_triggerjob_usage}{}\doxysubsection{Usage}\label{p_message_ib_s_message_ib_triggerjob_usage}
\begin{DoxyVerb}BltTriggerJobMessage msg = new BltTriggerJobMessage();
msg.setId("abc");
msg.setName("rulename");
msg.setArguments(new String[]{"a1","a2"});
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_triggerjob_xml}{}\doxysubsection{XML}\label{p_message_ib_s_message_ib_triggerjob_xml}
\begin{DoxyVerb}<?xml version="1.0" encoding="UTF-8"?>
<blttriggerjob>
  <id>abc</id>
  <name>rulename</name>
  <arguments>
    <arg>a1</arg>
    <arg>a2</arg>
  </arguments>
</blttriggerjob>
\end{DoxyVerb}


If you want to react specically on a trigger in a rule, you can implement it like this

\begin{DoxyVerb}  public IBltMessage handle(IBltMessage msg) {
    if (msg instanceof BltTriggerJobMessage) {
      ...
    }
    ...
  }
\end{DoxyVerb}
\hypertarget{p_message_ib_s_message_ib_triggerjob_xmlrpc}{}\doxysubsection{XMLRPC}\label{p_message_ib_s_message_ib_triggerjob_xmlrpc}
The usage of xmlrpc for job triggering is quite obscure but it is possible. It could for example for knowing that a specific trigger has been run or similar.

\begin{DoxyVerb}method = "triggerjob"
objects = {String(id), String(jobname), Array(String(argument), String(argument),..)}
\end{DoxyVerb}
 